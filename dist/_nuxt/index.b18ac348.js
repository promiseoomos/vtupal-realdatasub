import{_ as U}from"./WelcomeBase.8ace50e6.js";import{v as L,a as M,_ as z}from"./ActiveBoardBase.8b50a719.js";import{q as W,r as a,s as Y,S as O,f as F,R as H,a as u,h,b as l,w as J,i as S,v as D,u as t,t as c,j as d,k as B,l as Q,o as i}from"./entry.a5fcd4f4.js";import{f as X}from"./useFormatDigits.0d52ca80.js";import{v as Z}from"./vend.e5739c9e.js";import"./ModalBase.57ba2d8e.js";import"./useStrings.2b5df556.js";const ee={class:"rounded-md bg-gray-100 p-2"},te={class:"flex flex-wrap justify-between mt-4 px-2"},ae={class:"rounded-md bg-white p-2 mt-3"},le=["onSubmit"],se={class:"mt-3"},re=l("label",{for:"subject",class:"block mb-3 font-medium text-lg pl-1"},"Mobile Number",-1),oe={key:0,class:"mt-1 text-red-600"},ne={key:1,class:"mt-1 text-red-600"},ue={class:"mt-3"},ie=l("label",{for:"sender",class:"block mb-3 font-medium text-lg pl-1"},"Amount",-1),ce={class:"mt-2 text-green-600"},de={key:2,class:"mt-1 text-red-600"},me={key:0},ve={key:1},pe={class:"text-center p-2 mt-3"},fe=["disabled"],_e={key:0,class:"animate-spin h-7 w-7 -mb-2 mr-3 pt-2 border-r-2 border-b-2 border-l-2 border-whtie rounded-full inline-block"},he={key:4,class:"text-center p-2 mt-3"},be=["disabled"],Be={__name:"index",setup(ge){const p=W(),T=Z();let y=a({}),w=a({}),k=a({}),E=a({});const e=a({recipient:"",bouquet:null,biller_code:"",phone:"",type:"Airtime",network:"",country:"NG",amount:null,charge_amount:null,face_amount:0,famount:"\u20A60",userId:p.details.track_id,transactionType:"airtime-payment",paymentChannel:"Simhosting",charge:.5,currency:p.details.currency});a([]);const b=Y();let f=a(""),x=a(0),N=a([]);a(0),a("");let A=a({}),V=a(!1),r=a({}),n=a(!1),m=a(5),_=a(!1),q=a();const $=()=>{n.value=!0,q.value=setInterval(R,1e3)},G=()=>{clearInterval(q.value),n.value=!1,m.value=5,_.value=!1};O(m,()=>{m.value<=0&&(clearInterval(q.value),_.value=!0,C())});const R=()=>{m.value--},P=()=>{if(N.value.length>0){let s=N.value.find(v=>v.standard_name==f.value.toLowerCase()+"_airtime"),o=s.pricing;o=="value"?e.value.amount=Number(s[p.details.type+"_price"]):o=="percentage"&&(x.value=Math.round(e.value.amount-e.value.amount*Number(s[p.details.type+"_percentage"]/100))),e.value.face_amount=e.value.amount;let g=X(x.value);e.value.famount=p.details.currency=="NGN"?`\u20A6${g}`:`$${g}`,n.value=!1}};async function C(){n.value=!0,e.value.charge_amount=x.value,e.value.network=f.value;try{await T.buyAirtime(e.value).then(s=>{n.value=!1,r.value=s})}catch(s){r.value=s,n.value=!1}finally{m.value=5,_.value=!1}}const I=F(()=>n.value==!0||V.value==!0||A.value.status==!1||e.value.recipient.length==0||e.value.amount<=0);O(()=>b.query.network,s=>{e.value.recipient="",f.value=null,e.value.biller_code="",e.value.phone="",e.value.type="",e.value.country="",e.value.amount="",e.value.famount="\u20A60",A.value={},r.value={},e.value.bouquet=null});function K(){y.value=L(e.value.recipient),w.value=M(e.value.recipient,11),k.value=L(e.value.amount),E.value=M(e.value.amount,11)}return H(()=>{if(b.query.network){b.query.network.length>0&&(f.value=b.query.network);{let s=T.services2.filter(o=>o.module=="Airtime"&&o.submodule==f.value);s.length>0&&(N.value=s)}}}),(s,o)=>{const g=U,v=z;return i(),u("div",null,[h(g),l("div",ee,[l("div",te,[h(v,{class:"w-1/5 h-32",icon:"mtn.jpg",text:"MTN",link:"dashboard-vtuairtime",prefix:"newtork",query:{network:"MTN"}}),h(v,{class:"w-1/5 h-32",icon:"glo.jpg",text:"GLO",link:"dashboard-vtuairtime",prefix:"newtork",query:{network:"GLO"}}),h(v,{class:"w-1/5 h-32",icon:"airtel.jpg",text:"AIRTEL",link:"dashboard-vtuairtime",prefix:"newtork",query:{network:"AIRTEL"}}),h(v,{class:"w-1/5 h-32",icon:"9mobile.jpg",text:"9MOBILE",link:"dashboard-vtuairtime",prefix:"newtork",query:{network:"9MOBILE"}})]),l("div",ae,[l("form",{onSubmit:J(C,["prevent"])},[l("div",se,[re,S(l("input",{type:"text",onKeyup:K,"onUpdate:modelValue":o[0]||(o[0]=j=>t(e).recipient=j),id:"subject",class:"p-3 rounded-md w-full ring-0 border border-gray-200"},null,544),[[D,t(e).recipient]])]),t(y).status?d("",!0):(i(),u("p",oe,c(t(y).message),1)),t(w).status?d("",!0):(i(),u("p",ne,c(t(w).message),1)),l("div",ue,[ie,S(l("input",{type:"number",min:"0",onKeyup:P,"onUpdate:modelValue":o[1]||(o[1]=j=>t(e).amount=j),id:"sender",class:"p-3 rounded-md w-full ring-0 border border-gray-200",placeholder:"3000"},null,544),[[D,t(e).amount]])]),l("p",ce,"You will be charged "+c(t(e).famount)+" for this Airtime Purchase",1),t(k).status?d("",!0):(i(),u("div",de,c(t(k).message),1)),t(r)?(i(),u("div",{key:3,class:B(["rounded-md p-3 mt-3",{"text-red-600 bg-red-600/[.2]":t(r).status=="error","text-green-600 bg-green-600/[.2]":t(r).status=="success"}])},[t(r).status=="error"?(i(),u("p",me,c(t(r).message),1)):d("",!0),t(r).status=="success"?(i(),u("p",ve,c(t(r).message),1)):d("",!0)],2)):d("",!0),l("div",pe,[l("button",{disabled:t(I),class:B([{"opacity-50":t(I)},"p-3 px-10 bg-[#0f8B8D] w-full lg:w-1/2 text-white rounded-md font-bold text-md hover:bg-[#0a5556]"]),onClick:$},[t(n)?(i(),u("span",_e)):d("",!0),Q(" Purchase "+c(s.$route.query.network)+" Airtime",1)],10,fe)]),t(n)?(i(),u("div",he,[l("button",{disabled:t(_),onClick:G,class:B([{"opacity-50":t(_)},"p-2 bg-black w-full lg:w-1/2 text-white rounded-md font-bold text-lg"])}," Cancel ("+c(t(m))+") ",11,be)])):d("",!0)],40,le)])])])}}};export{Be as default};
