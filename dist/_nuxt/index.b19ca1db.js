import{_ as K}from"./WelcomeBase.d566a554.js";import{v as T,a as q,_ as L}from"./ActiveBoardBase.7e2fb3ce.js";import{q as R,r as s,s as z,R as H,S as I,f as W,a as r,h as V,b as a,w as J,t as c,u as e,i as M,K as Q,F as X,B as Y,v as D,j as m,k as S,l as Z,o as u}from"./entry.9a5b8fbf.js";import{f as ee}from"./useFormatDigits.0d52ca80.js";import{_ as $}from"./getAmount.a622716e.js";import{v as te}from"./vend.d0cdc105.js";import"./ModalBase.2f1919b6.js";import"./useStrings.2b5df556.js";const ae={class:"rounded-md bg-gray-100 p-2"},le={class:"flex flex-wrap justify-between mt-4 px-2"},se={class:"rounded-md bg-white p-2 mt-3"},ne=["onSubmit"],oe={class:"mt-3"},re={for:"subject",class:"block mb-3 font-medium text-lg pl-1"},ue=a("option",{value:"null"},"--Select product Plan--",-1),ie=["value"],de={class:"mt-3"},ce=a("label",{for:"subject",class:"block mb-3 font-medium text-lg pl-1"},"Mobile Number",-1),me=["disabled"],pe={key:0,class:"mt-1 text-red-600"},ve={key:1,class:"mt-1 text-red-600"},_e={class:"mt-3"},fe=a("label",{for:"sender",class:"block mb-3 font-medium text-lg pl-1"},"Amount ",-1),be={key:2,class:"mt-1 text-red-600"},he={key:0},ge={key:1},ye={class:"text-center p-2 mt-3"},ke=["disabled"],we={key:0,class:"animate-spin h-7 w-7 -mb-2 mr-3 pt-2 border-r-2 border-b-2 border-l-2 border-whtie rounded-full inline-block"},xe={key:4,class:"text-center p-2 mt-3"},Ne=["disabled"],De={__name:"index",setup(Me){const p=R(),C=te();let y=s({}),k=s({}),w=s({}),E=s({}),b=s([]);const h=z();let v=s("");s(0),s("");const t=s({recipient:"",product:null,biller_code:"",phone:"",type:"SME",country:"NG",amount:"",face_amount:0,network:"",famount:"",userId:p.details.track_id,transactionType:"smedata-payment",paymentChannel:"SIMHost_API",charge:.5,currency:p.details.currency});H(()=>{if(h.query.network){h.query.network.length>0&&(v.value=h.query.network);{let l=C.services2.filter(n=>n.module=="SME"&&n.submodule==v.value);l.length>0&&(b.value=l)}}});const P=()=>{if(b.value.length>0){let l=b.value.find(N=>N.standard_name==t.value.product),n=l.pricing;n=="value"?t.value.amount=Math.round(Number(l[p.details.type+"_price"])):n=="percentage"&&(t.value.amount=Math.round(Number(l.face_price)+Number(l.face_price)*Number(l[p.details.type+"_percentage"]/100))),t.value.face_amount=l.face_price;let g=ee(t.value.amount);t.value.famount=p.details.currency=="NGN"?`\u20A6${g}`:`$${g}`,d.value=!1}};let i=s({}),d=s(!1),_=s(5),f=s(!1),x=s();const A=()=>{d.value=!0,x.value=setInterval(U,1e3)},O=()=>{clearInterval(x.value),d.value=!1,_.value=5,f.value=!1};I(_,()=>{_.value<=0&&(clearInterval(x.value),f.value=!0,j())});const U=()=>{_.value--};async function j(){d.value=!0,t.value.network=v.value;try{await C.buySME(t.value).then(l=>{d.value=!1,i.value=l,t.value.recipient="",v.value=null,t.value.biller_code="",t.value.phone="",t.value.type="",t.value.amount=""})}catch(l){i.value=l,d.value=!1}finally{_.value=5,f.value=!1}}const B=W(()=>d.value==!0||t.value.recipient.length==0||t.value.amount<=0);I(()=>h.query.network,l=>{t.value.recipient="",v.value=null,t.value.biller_code="",t.value.phone="",t.value.type="",t.value.country="",t.value.amount="",i.value={},t.value.product=null,d.value=!1});function F(){y.value=T(t.value.recipient),k.value=q(t.value.recipient,11),w.value=T(t.value.amount),E.value=q(t.value.amount,11)}return(l,n)=>{const g=K,N=L;return u(),r("div",null,[V(g),a("div",ae,[a("div",le,[V(N,{class:"w-1/5 h-32",icon:"mtn.jpg",text:"MTN",link:"dashboard-smedata",query:{network:"MTN"}})]),a("div",se,[a("form",{onSubmit:J(j,["prevent"])},[a("div",oe,[a("label",re,"Choose the "+c(e(v))+" Plan",1),M(a("select",{class:"p-3 rounded-md w-full ring-0 border border-gray-200","onUpdate:modelValue":n[0]||(n[0]=o=>e(t).product=o),onChange:P},[ue,(u(!0),r(X,null,Y(e(b),(o,G)=>(u(),r("option",{key:G,value:o.standard_name},c(o.display_name)+" "+c(o.pricing=="percentage"?e($)(Number(o.face_price),Number(o[e(p).details.type+"_percentage"])):e($)(Number(o[e(p).details.type+"_price"]),0)),9,ie))),128))],544),[[Q,e(t).product]])]),a("div",de,[ce,M(a("input",{type:"text",disabled:e(v).length==0,onKeyup:F,"onUpdate:modelValue":n[1]||(n[1]=o=>e(t).recipient=o),id:"subject",class:"p-3 rounded-md w-full ring-0 border border-gray-200"},null,40,me),[[D,e(t).recipient]])]),e(y).status?m("",!0):(u(),r("p",pe,c(e(y).message),1)),e(k).status?m("",!0):(u(),r("p",ve,c(e(k).message),1)),a("div",_e,[fe,M(a("input",{type:"text",disabled:!0,"onUpdate:modelValue":n[2]||(n[2]=o=>e(t).famount=o),id:"sender",class:"p-3 rounded-md w-full ring-0 border border-gray-200",placeholder:"3000"},null,512),[[D,e(t).famount]])]),e(w).status?m("",!0):(u(),r("div",be,c(e(w).message),1)),e(i)?(u(),r("div",{key:3,class:S(["rounded-md p-3 mt-3",{"text-red-600 bg-red-600/[.2]":e(i).status=="error","text-green-600 bg-green-600/[.2]":e(i).status=="success"}])},[e(i).status=="error"?(u(),r("p",he,c(e(i).message),1)):m("",!0),e(i).status=="success"?(u(),r("p",ge,c(e(i).message),1)):m("",!0)],2)):m("",!0),a("div",ye,[a("button",{disabled:e(B),class:S([{"opacity-50":e(B)},"p-3 px-10 bg-[#0f8B8D] w-full lg:w-1/2 text-white rounded-md font-bold text-md hover:bg-[#0a5556]"]),onClick:A},[e(d)?(u(),r("span",we)):m("",!0),Z(" Make "+c(l.$route.query.type)+" Payment",1)],10,ke)]),e(d)?(u(),r("div",xe,[a("button",{disabled:e(f),onClick:O,class:S([{"opacity-50":e(f)},"p-2 bg-black w-full lg:w-1/2 text-white rounded-md font-bold text-lg"])}," Cancel ("+c(e(_))+") ",11,Ne)])):m("",!0)],40,ne)])])])}}};export{De as default};
