import{_ as M}from"./WelcomeBase.d566a554.js";import{v as D,a as N,_ as A}from"./ActiveBoardBase.7e2fb3ce.js";import{q as F,r as c,s as G,f as I,S as R,R as E,a as l,h as B,b as o,w as L,i as f,K as z,u as e,F as W,B as H,v as V,j as n,t as i,l as O,A as J,k as P,o as s}from"./entry.9a5b8fbf.js";import"./ModalBase.2f1919b6.js";import"./useStrings.2b5df556.js";const Q={class:"rounded-md bg-gray-100 p-2"},X={class:"flex flex-wrap justify-around mt-4 px-2"},Y={class:"rounded-md bg-white p-2 mt-3"},Z=["onSubmit"],ee={class:"mt-3"},te=o("label",{for:"subject",class:"block mb-3 font-medium text-lg pl-1"},"Choose Bouquet Plan",-1),ae=o("option",{value:"null"},"--Select Bouquet Plan--",-1),le=["value"],se={key:0,class:"mt-3"},oe=o("label",{for:"subject",class:"block mb-3 font-medium text-lg pl-1"},"IUC Number",-1),re=["disabled"],ue={key:1,class:"mt-3"},ne=o("label",{for:"subject",class:"block mb-3 font-medium text-lg pl-1"},"Smartcard Number",-1),ie={key:2,class:"animate-pulse font-semibold text-yellow-600"},de={key:3,class:"mt-1 text-red-600"},ce={key:4,class:"mt-1 text-red-600"},me={key:5,class:"mt-1 text-red-600"},pe={key:6,class:"mt-1 text-green-600"},ve={key:7,class:"mt-1 text-green-600"},_e={key:8,class:"mt-1 text-red-600"},be={class:"mt-3"},ye=o("label",{for:"sender",class:"block mb-3 font-medium text-lg pl-1"},"Phone (optional)",-1),he={key:9,class:"mt-1 text-red-600"},fe={key:10,class:"mt-1 text-red-600"},ge={key:0},ke={key:1},xe={class:"text-center p-2 mt-3"},we=["disabled"],qe={key:0,class:"animate-spin h-7 w-7 -mb-2 mr-3 pt-2 border-r-2 border-b-2 border-l-2 border-whtie rounded-full inline-block"},De={__name:"index",setup(Be){const p=F();let g=c({}),k=c({}),x=c({}),w=c({}),y=c(!1),v=c(!1);const t=c({recipient:"",bouquet:null,biller_code:"",phone:"",type:"",country:"",amount:"",userId:p.details.track_id,transactionType:"cable-payment",paymentChannel:"Flutterwave_API",charge:.5,currency:p.details.currency});let _=c([]);const C=G();p.getBillerCat({category:"all"});function $(){let r=_.value.filter(a=>a.item_code=t.value.bouquet)[0].biller_code,u=_.value.filter(a=>a.item_code=t.value.bouquet)[0].biller_name,q=_.value.filter(a=>a.item_code=t.value.bouquet)[0].amount,h=_.value.filter(a=>a.item_code=t.value.bouquet)[0].country;t.value.biller_code=r,t.value.amount=q,t.value.type=u,t.value.country=h,v.value=!1}let d=c({}),b=c(!1),m=c({});async function j(){b.value=!0,d.value={};try{await p.validateBill(t.value).then(r=>{d.value=r,b.value=!1})}catch(r){d.value=r,b.value=!1}}async function U(){v.value=!0;try{await p.createBill(t.value).then(r=>{v.value=!1,m.value=r})}catch(r){m.value=r,v.value=!1}}const S=I(()=>!!(v.value||b.value||d.value.status=="error"&&!y.value||t.value.bouquet=="null"));R(()=>C.query.type,r=>{t.value.recipient="",t.value.bouquet=null,t.value.biller_code="",t.value.phone="",t.value.type="",t.value.country="",t.value.amount="",d.value={},t.value.bouquet=null,m.value={},v.value=!1,b.value=!1});function T(){g.value=D(t.value.recipient),k.value=N(t.value.recipient,10),x.value=D(t.value.phone),w.value=N(t.value.phone,11)}return E(()=>{if(p.billercats.length>0){let r=p.billercats.filter(u=>u.name=="all");r.length>0&&(_.value=r[0].data.filter(u=>u.short_name==C.query.type))}}),(r,u)=>{const q=M,h=A;return s(),l("div",null,[B(q),o("div",Q,[o("div",X,[B(h,{class:"w-1/4 h-32",icon:"smilevoice.png",text:"GOTV",link:"dashboard-smile",query:{type:"voice"}}),B(h,{class:"w-1/4 h-32",icon:"smiledata.png",text:"DSTV",link:"dashboard-smile",query:{type:"data"}})]),o("div",Y,[o("form",{onSubmit:L(U,["prevent"])},[o("div",ee,[te,f(o("select",{class:"p-3 rounded-md w-full ring-0 border border-gray-200","onUpdate:modelValue":u[0]||(u[0]=a=>e(t).bouquet=a),onChange:$},[ae,(s(!0),l(W,null,H(e(_),(a,K)=>(s(),l("option",{key:K,value:a.item_code},i(a.biller_name)+" "+i(e(p).details.currency)+i(a.amount),9,le))),128))],544),[[z,e(t).bouquet]])]),r.$route.query.type=="GOTV"?(s(),l("div",se,[oe,f(o("input",{disabled:e(t).bouquet==null,type:"text",onKeyup:T,onBlur:j,"onUpdate:modelValue":u[1]||(u[1]=a=>e(t).recipient=a),id:"subject",class:"p-3 rounded-md w-full ring-0 border border-gray-200"},null,40,re),[[V,e(t).recipient]])])):n("",!0),r.$route.query.type!="GOTV"?(s(),l("div",ue,[ne,f(o("input",{type:"text",onKeyup:j,"onUpdate:modelValue":u[2]||(u[2]=a=>e(t).recipient=a),id:"subject",class:"p-3 rounded-md w-full ring-0 border border-gray-200"},null,544),[[V,e(t).recipient]])])):n("",!0),e(b)?(s(),l("p",ie,"Validating...")):n("",!0),e(d).status=="error"?(s(),l("p",de,i(e(d).message),1)):n("",!0),e(g).status?n("",!0):(s(),l("p",ce,i(e(g).message),1)),e(k).status?n("",!0):(s(),l("p",me,i(e(k).message),1)),e(d).status=="success"?(s(),l("p",pe,i(e(d).message),1)):n("",!0),e(d).status=="success"?(s(),l("p",ve,"Customer name :"+i(e(d).data.name),1)):n("",!0),e(d).status=="error"?(s(),l("p",_e,[O("Could not validate customer. "),o("span",{onClick:u[3]||(u[3]=a=>J(y)?y.value=!0:y=!0),class:"underline cursor-pointer text-blue-400"},"Proceed anyways.")])):n("",!0),o("div",be,[ye,f(o("input",{type:"text","onUpdate:modelValue":u[4]||(u[4]=a=>e(t).phone=a),onKeyup:T,id:"sender",class:"p-3 rounded-md w-full ring-0 border border-gray-200",placeholder:"09020801526"},null,544),[[V,e(t).phone]])]),e(x).status?n("",!0):(s(),l("div",he,i(e(x).message),1)),e(w).status?n("",!0):(s(),l("div",fe,i(e(w).message),1)),e(m)?(s(),l("div",{key:11,class:P(["rounded-md p-3 mt-3",{"text-red-600 bg-red-600/[.2]":e(m).status=="error","text-green-600 bg-green-600/[.2]":e(m).status=="success"}])},[e(m).status=="error"?(s(),l("p",ge,i(e(m).message),1)):n("",!0),e(m).status=="success"?(s(),l("p",ke,i(e(m).message),1)):n("",!0)],2)):n("",!0),o("div",xe,[o("button",{disabled:e(S),class:P([{"opacity-50":e(S)},"p-3 px-10 bg-[#0f8B8D] text-white rounded-md font-bold text-md hover:bg-[#0a5556]"]),type:"submit"},[e(v)?(s(),l("span",qe)):n("",!0),O(" Make "+i(r.$route.query.type)+" Payment",1)],10,we)])],40,Z)])])])}}};export{De as default};
