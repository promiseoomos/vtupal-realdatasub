import{_ as F}from"./WelcomeBase.8ace50e6.js";import{v as T,a as V,_ as z}from"./ActiveBoardBase.8b50a719.js";import{q as W,r as s,s as H,S as A,R as J,f as Q,a as r,h as k,b as l,w as X,t as u,u as t,i as C,K as Y,F as Z,B as ee,v as E,j as p,A as te,k as M,l as ae,o as i}from"./entry.a5fcd4f4.js";import{f as le}from"./useFormatDigits.0d52ca80.js";import{_ as ne}from"./getAmount.de9f595b.js";import{v as se}from"./vend.e5739c9e.js";import"./ModalBase.57ba2d8e.js";import"./useStrings.2b5df556.js";const oe={class:"rounded-md bg-gray-100 p-2"},re={class:"flex flex-wrap justify-between mt-4 px-2"},ue={class:"rounded-md bg-white p-2 mt-3"},ie=["onSubmit"],de={class:"mt-3"},ce={for:"subject",class:"block mb-3 font-medium text-lg pl-1"},me=l("option",{value:"null"},"--Select Bouquet Plan--",-1),ve=["value"],pe={class:"mt-3"},_e=l("label",{for:"subject",class:"block mb-3 font-medium text-lg pl-1"},"Mobile Number",-1),be=["disabled"],fe={key:0,class:"mt-1 text-red-600"},ge={key:1,class:"mt-1 text-red-600"},he={class:"mt-3"},ye=l("label",{for:"sender",class:"block mb-3 font-medium text-lg pl-1"},"Amount",-1),ke={key:2,class:"mt-1 text-red-600"},we={key:0},xe={key:1},Be={class:"text-center p-2 mt-3"},Se=["disabled"],je={key:0,class:"animate-spin h-7 w-7 -mb-2 mr-3 pt-2 border-r-2 border-b-2 border-l-2 border-whtie rounded-full inline-block"},Ne={key:4,class:"text-center p-2 mt-3"},qe=["disabled"],De={__name:"index",setup(Ce){const w=W(),b=se();let B=s({}),S=s({}),j=s({}),D=s({}),N=s(0),_=s("");b.getBillerCat();const e=s({mobile_number:"",bouquet:null,recipient:"",network:"",phone:"",type:"giftdata",country:"NG",amount:0,face_amount:0,userId:w.details.track_id,transactionType:"giftingdata-payment",paymentChannel:"Arise_data",charge:.5,plan:null,plan_type:"",Ported_number:!0,currency:w.details.currency});let v=s([]);const x=H();let h=s(""),P=b.services.data.find(o=>o.service_name=="data").service_suffix;A(()=>x.query.network,o=>{e.value.mobile_number="",h.value=null,e.value.phone="",e.value.country="",e.value.amount="",d.value={},e.value.bouquet=null}),J(()=>{if(x.query.network){x.query.network.length>0&&(h.value=x.query.network);{let o=b.services.data.find(n=>n.service_name=="data").percentage.find(n=>n.user_type==w.details.type);if(N.value=o==null?0:o.value,Object.keys(b.dataServices).length>0){let n=h.value+"_"+P,g=b.dataServices[n].ALL;g.length>0&&(v.value=g.filter(m=>m.plan_type!="SME"))}}}});function R(){if(v.value.length>0){let o=v.value.filter(a=>a.id==e.value.plan)[0].network,n=Number(v.value.filter(a=>a.id==e.value.plan)[0].plan_amount),g=v.value.filter(a=>a.id==e.value.plan)[0].plan+" "+v.value.filter(a=>a.id==e.value.plan)[0].month_validate+" "+v.value.filter(a=>a.id==e.value.plan)[0].plan_type;e.value.face_amount=n,e.value.amount=Math.round(n+n*N.value/100);let m=le(e.value.amount);_.value=w.details.currency=="NGN"?`\u20A6${m}`:`$${m}`,e.value.network=o,e.value.plan_type=g,c.value=!1}}let d=s({}),c=s(!1),f=s(5),y=s(!1),q=s();const $=()=>{c.value=!0,q.value=setInterval(K,1e3)},G=()=>{clearInterval(q.value),c.value=!1,f.value=5,y.value=!1};A(f,()=>{f.value<=0&&(clearInterval(q.value),y.value=!0,I())});const K=()=>{f.value--};async function I(){c.value=!0,e.value.recipient=e.value.mobile_number;try{await b.createBill(e.value).then(o=>{c.value=!1,d.value=o,e.value.plan=null,e.value.mobile_number="",_.value=""})}catch(o){c.value=!1,d.value=o,e.value.plan=null,e.value.mobile_number="",_.value=""}finally{f.value=5,y.value=!1}}const L=Q(()=>c.value==!0||e.value.mobile_number.length==0||e.value.amount<=0);function O(){B.value=T(e.value.mobile_number),S.value=V(e.value.mobile_number,11),j.value=T(e.value.amount),D.value=V(e.value.amount,11)}return(o,n)=>{const g=F,m=z;return i(),r("div",null,[k(g),l("div",oe,[l("div",re,[k(m,{class:"w-1/5 h-32",icon:"mtn.jpg",text:"MTN",link:"dashboard-giftingdata",query:{network:"MTN"}}),k(m,{class:"w-1/5 h-32",icon:"glo.jpg",text:"GLO",link:"dashboard-giftingdata",query:{network:"GLO"}}),k(m,{class:"w-1/5 h-32",icon:"airtel.jpg",text:"AIRTEL",link:"dashboard-giftingdata",query:{network:"AIRTEL"}}),k(m,{class:"w-1/5 h-32",icon:"9mobile.jpg",text:"9MOBILE",link:"dashboard-giftingdata",query:{network:"9MOBILE"}})]),l("div",ue,[l("form",{onSubmit:X(I,["prevent"])},[l("div",de,[l("label",ce,"Choose the "+u(t(h))+" Plan",1),C(l("select",{class:"p-3 rounded-md w-full ring-0 border border-gray-200","onUpdate:modelValue":n[0]||(n[0]=a=>t(e).plan=a),onChange:R},[me,(i(!0),r(Z,null,ee(t(v),(a,U)=>(i(),r("option",{key:U,value:a.id},u(a.plan)+" "+u(a.month_validate)+" "+u(t(ne)(Number(a.plan_amount),t(N))),9,ve))),128))],544),[[Y,t(e).plan]])]),l("div",pe,[_e,C(l("input",{type:"text",disabled:t(h).length==0,onKeyup:O,"onUpdate:modelValue":n[1]||(n[1]=a=>t(e).mobile_number=a),id:"subject",class:"p-3 rounded-md w-full ring-0 border border-gray-200"},null,40,be),[[E,t(e).mobile_number]])]),t(B).status?p("",!0):(i(),r("p",fe,u(t(B).message),1)),t(S).status?p("",!0):(i(),r("p",ge,u(t(S).message),1)),l("div",he,[ye,C(l("input",{type:"text",disabled:!0,"onUpdate:modelValue":n[2]||(n[2]=a=>te(_)?_.value=a:_=a),onKeyup:O,id:"sender",class:"p-3 rounded-md w-full ring-0 border border-gray-200",placeholder:"3000"},null,544),[[E,t(_)]])]),t(j).status?p("",!0):(i(),r("div",ke,u(t(j).message),1)),t(d)?(i(),r("div",{key:3,class:M(["rounded-md p-3 mt-3",{"text-red-600 bg-red-600/[.2]":t(d).status=="error","text-green-600 bg-green-600/[.2]":t(d).status=="success"}])},[t(d).status=="error"?(i(),r("p",we,u(t(d).message)+".",1)):p("",!0),t(d).status=="success"?(i(),r("p",xe,u(t(d).message),1)):p("",!0)],2)):p("",!0),l("div",Be,[l("button",{disabled:t(L),class:M([{"opacity-50":t(L)},"p-3 px-10 bg-[#0f8B8D] w-full lg:w-1/2 text-white rounded-md font-bold text-md hover:bg-[#0a5556]"]),onClick:$},[t(c)?(i(),r("span",je)):p("",!0),ae(" Make "+u(o.$route.query.type)+" Payment",1)],10,Se)]),t(c)?(i(),r("div",Ne,[l("button",{disabled:t(y),onClick:G,class:M([{"opacity-50":t(y)},"p-2 bg-black w-full lg:w-1/2 text-white rounded-md font-bold text-lg"])}," Cancel ("+u(t(f))+") ",11,qe)])):p("",!0)],40,ie)])])])}}};export{De as default};
