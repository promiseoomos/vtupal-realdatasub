import{_ as F}from"./WelcomeBase.d566a554.js";import{v as H,_ as J}from"./ActiveBoardBase.7e2fb3ce.js";import{q as O,r as a,s as R,R as U,S as C,f as z,a as c,h as v,b as s,w as G,t as u,u as e,i as S,v as E,j as d,k as B,l as W,o}from"./entry.9a5b8fbf.js";import{v as L}from"./vend.d0cdc105.js";import"./ModalBase.2f1919b6.js";import"./useStrings.2b5df556.js";const Q={class:"rounded-md bg-gray-100 p-2"},X={class:"flex flex-wrap justify-evenly gap-2 mt-4 px-2"},Y={class:"rounded-md bg-white p-2 mt-3"},Z=["onSubmit"],ee={class:"mt-3"},te={for:"subject",class:"block mb-3 font-medium text-lg pl-1"},ae={class:"mt-3"},se=s("label",{for:"subject",class:"block mb-3 font-medium text-lg pl-1"},"Meter Number",-1),le=["disabled"],re={key:0,class:"mt-1 text-red-600"},ce={key:1,class:"mt-1 text-green-600"},oe={key:2,class:"animate-pulse font-semibold text-yellow-600"},ie={key:3,class:"mt-1 text-red-600"},ne={key:4,class:"mt-1 text-green-600"},ue={class:"mt-3"},de=s("label",{for:"sender",class:"block mb-3 font-medium text-lg pl-1"},"Amount",-1),me={key:0},ve={key:1},pe={class:"text-center p-2 mt-3"},_e=["disabled"],be={key:0,class:"animate-spin h-7 w-7 -mb-2 mr-3 pt-2 border-r-2 border-b-2 border-l-2 border-whtie rounded-full inline-block"},ye={key:6,class:"text-center p-2 mt-3"},fe=["disabled"],qe={__name:"index",setup(he){const h=O(),k=L();let x=a({});a({}),a({}),a({});const t=a({meter_number:"",MeterType:1,biller_code:"",phone:"",type:"disco",country:"NG",amount:0,face_amount:0,recipient:"",disco_name:"",userId:h.details.track_id,transactionType:"electricity-payment",paymentChannel:"Flutterwave_API",charge:.5,currency:h.details.currency});a([]);const g=R();let b=a("");a("");let N=a(0),q=a("");U(()=>{g.query.disco&&g.query.disco.length>0&&(b.value=g.query.disco),q.value=k.services.data.find(n=>n.service_name=="electricity").service_suffix;let r=k.services.data.find(n=>n.service_name=="electricity").percentage.find(n=>n.user_type==h.details.type);N.value=r==null?0:r.value/100});let l=a({}),y=a(!1),i=a({});async function P(){y.value=!0,l.value={};try{await h.validateBill(t.value).then(r=>{l.value=r,y.value=!1})}catch(r){l.value=r,y.value=!1}}let m=a(!1),_=a(5),f=a(!1),w=a();const T=()=>{m.value=!0,w.value=setInterval(M,1e3)},D=()=>{clearInterval(w.value),m.value=!1,_.value=5,f.value=!1};C(_,()=>{_.value<=0&&(clearInterval(w.value),f.value=!0,I())});const M=()=>{_.value--};async function I(){m.value=!0,t.value.recipient=t.value.meter_number,t.value.disco_name=b.value+" "+q.value;try{await k.createBill(t.value).then(r=>{m.value=!1,i.value=r})}catch(r){i.value=r,m.value=!1}finally{_.value=5,f.value=!1}}const A=()=>{l.value={}},V=z(()=>m.value==!0||y.value==!0||l.value.status==!1||t.value.meter_number.length==0||t.value.amount<=0);C(()=>g.query.disco,r=>{t.value.meter_number="",b.value="",t.value.biller_code="",t.value.phone="",t.value.type="",t.value.country="",t.value.amount="",l.value={},i.value={},m.value=!1});function K(){x.value=H(t.value.meter_number)}return(r,n)=>{const $=F,p=J;return o(),c("div",null,[v($),s("div",Q,[s("div",X,[v(p,{class:"w-1/5",icon:"ikeja-electric.jpg",text:"Ikeja",link:"dashboard-electricity",query:{disco:"Ikeja"}}),v(p,{class:"w-1/5",icon:"ibadan-electric.jpg",text:"Ibadan",link:"dashboard-electricity",query:{disco:"Ibadan"}}),v(p,{class:"w-1/5",icon:"jos-electric.jpg",text:"Jos",link:"dashboard-electricity",query:{disco:"Jos"}}),v(p,{class:"w-1/5",icon:"kaduna-electric.jpg",text:"Kaduna",link:"dashboard-electricity",query:{disco:"Kaduna"}}),v(p,{class:"w-1/5",icon:"enugu-electric.jpg",text:"Enugu",link:"dashboard-electricity",query:{disco:"Enugu"}}),v(p,{class:"w-1/5",icon:"eko-electric.jpg",text:"Eko",link:"dashboard-electricity",query:{disco:"Eko"}}),v(p,{class:"w-1/5",icon:"benin-electric.jpg",text:"Benin",link:"dashboard-electricity",query:{disco:"Benin"}}),v(p,{class:"w-1/5",icon:"portharcourt-electric.jpg",text:"Port Harcourt",link:"dashboard-electricity",query:{disco:"Port Harcourt"}})]),s("div",Y,[s("form",{onSubmit:G(I,["prevent"])},[s("div",ee,[s("label",te,"Pay Electricity Bill for "+u(e(b))+" Disco",1)]),s("div",ae,[se,S(s("input",{type:"text",disabled:e(b).length==0,onFocus:A,onKeyup:K,onBlur:P,"onUpdate:modelValue":n[0]||(n[0]=j=>e(t).meter_number=j),id:"subject",class:"p-3 rounded-md w-full ring-0 border border-gray-200"},null,40,le),[[E,e(t).meter_number]])]),e(x).status?d("",!0):(o(),c("p",re,u(e(x).message),1)),e(l).status=="success"?(o(),c("p",ce,u(e(l).message),1)):d("",!0),e(y)?(o(),c("p",oe,"Validating...")):d("",!0),e(l).status=="error"?(o(),c("p",ie,u(e(l).message),1)):d("",!0),e(l).status=="success"?(o(),c("p",ne,"Validated details : "+u(e(l).data.name)+" ("+u(e(l).data.customer)+")",1)):d("",!0),s("div",ue,[de,S(s("input",{type:"number",min:"0","onUpdate:modelValue":n[1]||(n[1]=j=>e(t).amount=j),id:"sender",class:"p-3 rounded-md w-full ring-0 border border-gray-200",placeholder:"3000"},null,512),[[E,e(t).amount]])]),e(i)?(o(),c("div",{key:5,class:B(["rounded-md p-3 mt-3",{"text-red-600 bg-red-600/[.2]":e(i).status=="error","text-green-600 bg-green-600/[.2]":e(i).status=="success"}])},[e(i).status=="error"?(o(),c("p",me,u(e(i).message)+".",1)):d("",!0),e(i).status=="success"?(o(),c("p",ve,u(e(i).message),1)):d("",!0)],2)):d("",!0),s("div",pe,[s("button",{disabled:e(V),class:B([{"opacity-50":e(V)},"p-3 px-10 bg-[#0f8B8D] w-full lg:w-1/2 text-white rounded-md font-bold text-md hover:bg-[#0a5556]"]),onClick:T},[e(m)?(o(),c("span",be)):d("",!0),W(" Make "+u(r.$route.query.type)+" Payment",1)],10,_e)]),e(m)?(o(),c("div",ye,[s("button",{disabled:e(f),onClick:D,class:B([{"opacity-50":e(f)},"p-2 bg-black w-full lg:w-1/2 text-white rounded-md font-bold text-lg"])}," Cancel ("+u(e(_))+") ",11,fe)])):d("",!0)],40,Z)])])])}}};export{qe as default};
